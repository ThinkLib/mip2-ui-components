{"version":3,"sources":["../../../src/components/VTimePicker/VTimePickerClock.js"],"names":[],"mappings":"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","sourcesContent":["import '../../stylus/components/_time-picker-clock.styl'\n\n// Mixins\nimport Colorable from '../../mixins/colorable'\nimport Themeable from '../../mixins/themeable'\n\n/* @vue/component */\nexport default {\n  name: 'v-time-picker-clock',\n\n  mixins: [\n    Colorable,\n    Themeable\n  ],\n\n  props: {\n    allowedValues: Function,\n    double: Boolean,\n    format: {\n      type: Function,\n      default: val => val\n    },\n    max: {\n      type: Number,\n      required: true\n    },\n    min: {\n      type: Number,\n      required: true\n    },\n    scrollable: Boolean,\n    rotate: {\n      type: Number,\n      default: 0\n    },\n    size: {\n      type: [Number, String],\n      default: 270\n    },\n    step: {\n      type: Number,\n      default: 1\n    },\n    value: Number\n  },\n\n  data () {\n    return {\n      defaultColor: 'accent',\n      inputValue: this.value,\n      isDragging: false,\n      valueOnMouseDown: null,\n      valueOnMouseUp: null\n    }\n  },\n\n  computed: {\n    count () {\n      return this.max - this.min + 1\n    },\n    innerRadius () {\n      return this.radius - Math.max(this.radius * 0.4, 48)\n    },\n    outerRadius () {\n      return this.radius - 4\n    },\n    roundCount () {\n      return this.double ? (this.count / 2) : this.count\n    },\n    degreesPerUnit () {\n      return 360 / this.roundCount\n    },\n    degrees () {\n      return this.degreesPerUnit * Math.PI / 180\n    },\n    radius () {\n      return this.size / 2\n    },\n    displayedValue () {\n      return this.value == null ? this.min : this.value\n    }\n  },\n\n  watch: {\n    value (value) {\n      this.inputValue = value\n    }\n  },\n\n  methods: {\n    wheel (e) {\n      e.preventDefault()\n\n      const delta = Math.sign(e.wheelDelta || 1)\n      let value = this.displayedValue\n      do {\n        value = value + delta\n        value = (value - this.min + this.count) % this.count + this.min\n      } while (!this.isAllowed(value) && value !== this.displayedValue)\n\n      if (value !== this.displayedValue) {\n        this.update(value)\n      }\n    },\n    handScale (value) {\n      return this.double && (value - this.min >= this.roundCount) ? (this.innerRadius / this.radius) : (this.outerRadius / this.radius)\n    },\n    isAllowed (value) {\n      return !this.allowedValues || this.allowedValues(value)\n    },\n    genValues () {\n      const children = []\n\n      for (let value = this.min; value <= this.max; value = value + this.step) {\n        const classes = {\n          active: value === this.displayedValue,\n          disabled: !this.isAllowed(value)\n        }\n\n        children.push(this.$createElement('span', {\n          'class': this.addBackgroundColorClassChecks(classes, value === this.value ? this.computedColor : null),\n          style: this.getTransform(value),\n          domProps: { innerHTML: `<span>${this.format(value)}</span>` }\n        }))\n      }\n\n      return children\n    },\n    genHand () {\n      const scale = `scaleY(${this.handScale(this.displayedValue)})`\n      const angle = this.rotate + this.degreesPerUnit * (this.displayedValue - this.min)\n\n      return this.$createElement('div', {\n        staticClass: 'v-time-picker-clock__hand',\n        'class': this.value == null ? {} : this.addBackgroundColorClassChecks(),\n        style: {\n          transform: `rotate(${angle}deg) ${scale}`\n        }\n      })\n    },\n    getTransform (i) {\n      const { x, y } = this.getPosition(i)\n      return { transform: `translate(${x}px, ${y}px)` }\n    },\n    getPosition (value) {\n      const radius = (this.radius - 24) * this.handScale(value)\n      const rotateRadians = this.rotate * Math.PI / 180\n      return {\n        x: Math.round(Math.sin((value - this.min) * this.degrees + rotateRadians) * radius),\n        y: Math.round(-Math.cos((value - this.min) * this.degrees + rotateRadians) * radius)\n      }\n    },\n    onMouseDown (e) {\n      e.preventDefault()\n\n      this.valueOnMouseDown = null\n      this.valueOnMouseUp = null\n      this.isDragging = true\n      this.onDragMove(e)\n    },\n    onMouseUp () {\n      this.isDragging = false\n      if (this.valueOnMouseUp !== null && this.isAllowed(this.valueOnMouseUp)) {\n        this.$emit('change', this.valueOnMouseUp)\n      }\n    },\n    onDragMove (e) {\n      e.preventDefault()\n      if (!this.isDragging && e.type !== 'click') return\n\n      const { width, top, left } = this.$refs.clock.getBoundingClientRect()\n      const { clientX, clientY } = 'touches' in e ? e.touches[0] : e\n      const center = { x: width / 2, y: -width / 2 }\n      const coords = { x: clientX - left, y: top - clientY }\n      const handAngle = Math.round(this.angle(center, coords) - this.rotate + 360) % 360\n      const insideClick = this.double && this.euclidean(center, coords) < (this.outerRadius + this.innerRadius) / 2 - 16\n      const value = Math.round(handAngle / this.degreesPerUnit) +\n        this.min + (insideClick ? this.roundCount : 0)\n\n      // Necessary to fix edge case when selecting left part of max value\n      let newValue\n      if (handAngle >= (360 - this.degreesPerUnit / 2)) {\n        newValue = insideClick ? this.max : this.min\n      } else {\n        newValue = value\n      }\n\n      if (this.isAllowed(value)) {\n        if (this.valueOnMouseDown === null) {\n          this.valueOnMouseDown = newValue\n        }\n        this.valueOnMouseUp = newValue\n        this.update(newValue)\n      }\n    },\n    update (value) {\n      if (this.inputValue !== value) {\n        this.inputValue = value\n        this.$emit('input', value)\n      }\n    },\n    euclidean (p0, p1) {\n      const dx = p1.x - p0.x\n      const dy = p1.y - p0.y\n\n      return Math.sqrt(dx * dx + dy * dy)\n    },\n    angle (center, p1) {\n      const value = 2 * Math.atan2(p1.y - center.y - this.euclidean(center, p1), p1.x - center.x)\n      return Math.abs(value * 180 / Math.PI)\n    }\n  },\n\n  render () {\n    const data = {\n      staticClass: 'v-time-picker-clock',\n      class: {\n        'v-time-picker-clock--indeterminate': this.value == null,\n        ...this.themeClasses\n      },\n      on: {\n        mousedown: this.onMouseDown,\n        mouseup: this.onMouseUp,\n        mouseleave: () => (this.isDragging && this.onMouseUp()),\n        touchstart: this.onMouseDown,\n        touchend: this.onMouseUp,\n        mousemove: this.onDragMove,\n        touchmove: this.onDragMove\n      },\n      style: {\n        height: `${this.size}px`,\n        width: `${this.size}px`\n      },\n      ref: 'clock'\n    }\n\n    this.scrollable && (data.on.wheel = this.wheel)\n\n    return this.$createElement('div', data, [\n      this.genHand(),\n      this.genValues()\n    ])\n  }\n}\n"],"sourceRoot":""}